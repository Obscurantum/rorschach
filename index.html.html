<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EYE OF EREN: RORSCHACH V60</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/geist@1.0.3/dist/fonts/geist.css">
    <style>
        /* ==========================================================
           CSS: HIGH REFRESH RATE OPTIMIZED UI
           ========================================================== */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --fast-ease: cubic-bezier(0.4, 0, 0.2, 1); 
            --main-color: #1DB954; 
            --bg-color: #050505;
            --glass-card: rgba(50, 50, 50, 0.45); 
            --glass-border: rgba(255, 255, 255, 0.15);
            --text-primary: #F5F5F7;
            --text-secondary: #A1A1A6;
        }

        body { 
            overflow: hidden; background: var(--bg-color); 
            font-family: "Inter", -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", Roboto, sans-serif;
            color: var(--text-primary); display: flex; justify-content: center; align-items: center; height: 100vh;
            -webkit-font-smoothing: antialiased;
        }
        
        #canvas { position: fixed; top: 0; left: 0; z-index: 1; transition: transform 2.5s var(--fast-ease); }

        #intro-overlay {
            position: absolute; z-index: 100; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            cursor: pointer; transition: all 1.2s var(--fast-ease);
            background: rgba(0, 0, 0, 0.92); backdrop-filter: blur(15px);
        }
        
        #intro-overlay.observer-mode { background: rgba(0, 0, 0, 0.15) !important; backdrop-filter: blur(0px) !important; }
        
        #intro-text { 
            font-family: "Geist", sans-serif; font-size: 2rem; font-weight: 100; 
            letter-spacing: 25px; text-align: center; text-transform: uppercase; color: #fff; 
        }

        .intro-hidden { opacity: 0; visibility: hidden; pointer-events: none; transform: scale(1.05); }

        #main-app-window {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(1.02);
            z-index: 10; width: 92vw; max-width: 1350px; height: 85vh;
            display: grid; grid-template-columns: 260px 1fr; 
            overflow: hidden; 
            backdrop-filter: blur(40px) saturate(180%); -webkit-backdrop-filter: blur(40px) saturate(180%);
            background-color: var(--glass-card); border: 1px solid var(--glass-border); 
            border-radius: 44px; box-shadow: 0 40px 120px rgba(0, 0, 0, 0.5); 
            opacity: 0; transition: all 1s var(--fast-ease); pointer-events: none;
        }
        #main-app-window.active { opacity: 1; transform: translate(-50%, -50%) scale(1); pointer-events: all; }

        #sidebar { padding: 60px 40px; border-right: 1px solid var(--glass-border); display: flex; flex-direction: column; background: rgba(0,0,0,0.1); }
        .nav-title { font-size: 11px; color: var(--main-color); letter-spacing: 6px; margin-bottom: 60px; font-weight: 800; text-transform: uppercase; }
        
        .nav-link { 
            font-size: 13px; padding: 18px 0; display: block; cursor: pointer; color: var(--text-secondary); 
            transition: all 0.4s var(--fast-ease); text-decoration: none; letter-spacing: 1.5px; text-transform: uppercase; 
        }
        .nav-link:hover { color: #FFF; transform: translateX(5px); }
        .nav-link.active { color: #FFF; font-weight: 700; border-left: 2px solid var(--main-color); padding-left: 20px; }

        .hud-stats { margin-top: auto; padding-top: 30px; }
        .stat { font-size: 9px; margin: 12px 0; color: #FFF; text-transform: uppercase; letter-spacing: 2px; opacity: 0.6; }
        .stat span { color: var(--main-color); float: right; font-weight: 900; }
        .bar-container { width: 100%; height: 2px; background: rgba(255, 255, 255, 0.1); margin: 10px 0; overflow: hidden; border-radius: 1px; }
        .bar-fill { height: 100%; background: var(--main-color); width: 0%; transition: width 0.8s var(--fast-ease); }

        #main-content-area { position: relative; overflow: hidden; }
        
        .view-pane { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; padding: 80px; 
            overflow-y: auto; opacity: 0; display: none; 
            transform: translate3d(0, 40px, 0); 
            transition: opacity 0.5s var(--fast-ease), transform 0.6s var(--fast-ease); 
            scrollbar-width: none; 
        }
        .view-pane.active { opacity: 1; transform: translate3d(0, 0, 0); display: block; }
        
        h2 { font-size: 42px; font-weight: 200; margin-bottom: 25px; letter-spacing: -1.5px; color: var(--text-primary); }
        p { font-size: 16px; color: rgba(255,255,255,0.7); line-height: 2; max-width: 650px; font-weight: 300; }

        #message-body { width: 100%; height: 250px; background: rgba(0,0,0,0.2); border: 1px solid var(--glass-border); border-radius: 32px; padding: 35px; color: #fff; font-family: inherit; font-size: 15px; margin-bottom: 30px; outline: none; transition: 0.4s; resize: none; }
        .transmit-btn { background: var(--main-color); color: #000; border: none; padding: 20px 60px; border-radius: 60px; font-size: 12px; letter-spacing: 2px; font-weight: 800; cursor: pointer; transition: 0.4s; text-transform: uppercase; }
        .transmit-btn:disabled { opacity: 0.5; cursor: not-allowed; }
    </style>
</head>
<body>

<canvas id="canvas"></canvas>

<div id="intro-overlay" onclick="startFlythrough()">
    <div id="intro-text">PEER INTO THE EYE OF EREN</div>
</div>

<div id="main-app-window">
    <div id="sidebar">
        <h1 class="nav-title">RORSCHACH</h1>
        <a href="#" class="nav-link home-portal" onclick="returnToPortal(event)">HOME PORTAL</a>
        <a href="#" class="nav-link active" onclick="handleNavigation(event, this, 'view-about')">CORE PROTOCOL</a>
        <a href="#" class="nav-link" onclick="handleNavigation(event, this, 'view-archive')">ARCHIVE</a>
        <a href="#" class="nav-link" onclick="handleNavigation(event, this, 'view-contact')">GATEWAY</a>

        <div class="hud-stats">
            <div class="stat">TOPOLOGY <span id="view-disp">SYNCED</span></div>
            <div class="stat">EVOLUTION <span id="mode-disp">INIT</span></div>
            <div class="bar-container"><div class="bar-fill" id="progress-bar"></div></div>
            <div style="font-size: 7px; color: var(--text-secondary); text-align: left; letter-spacing: 2px; margin-top: 10px;">RORSCHACH V60.0.1 / HIGH-HZ</div>
        </div>
    </div>
    
    <div id="main-content-area">
        <div id="view-about" class="view-pane active">
            <h2>RORSCHACH: KINETIC DEPTH</h2>
            <p>A projection of pure algorithmic intent. The system is designed to mirror neural patterns through abstract geometric evolution. Every particle is a signature of the core manifestation.</p>
        </div>
        <div id="view-archive" class="view-pane">
            <h2>ARCHIVE</h2>
            <p>Eren's manifestos will be displayed here.</p>
        </div>
        <div id="view-contact" class="view-pane">
            <h2>API GATEWAY</h2>
            <div id="contact-form">
                <textarea id="message-body" placeholder="Input string for API transmission..."></textarea>
                <button class="transmit-btn" id="api-btn" onclick="sendToApi()">TRANSMIT TO CLOUD</button>
            </div>
        </div>
    </div>
</div>

<script>
// ================= CORE ENGINE =================
const CONFIG = {
    particleCount: 22000, vibrationStrength: 5.5, friction: 0.93,
    transitionSpeed: 0.0018, pixelSize: 1.8, autoSkipTime: 900, focalLength: 850
};

const RESONANCE_SPECTRUM = [
    { r:29, g:185, b:84, p1:3, p2:2, mode:0 },
    { r:255, g:60, b:60, p1:15, p2:9, mode:1 },
    { r:255, g:255, b:255, p1:2, p2:2, mode:2 },
    { r:160, g:80, b:255, p1:6, p2:1, mode:5 }
];

let activeColor = {r: 29, g: 185, b: 84};
let hasEntered = false;

const x = new Float32Array(CONFIG.particleCount), y = new Float32Array(CONFIG.particleCount);
const vx = new Float32Array(CONFIG.particleCount), vy = new Float32Array(CONFIG.particleCount);
const settled = new Float32Array(CONFIG.particleCount), age = new Float32Array(CONFIG.particleCount);

let canvas, ctx, width, height, centerX, centerY;
let mode = 0, p1 = 3, p2 = 2, targetP1 = 5, targetP2 = 3;
let topology = 0, targetTopology = 0, lerpProgress = 0, time = 0, autoTimer = 0;
let isFlythroughActive = false, currentView = 'view-about';

function startFlythrough() {
    isFlythroughActive = true;
    hasEntered = true;
    document.getElementById('intro-overlay').classList.add('intro-hidden');
    document.getElementById('canvas').style.transform = 'scale(1.2)';
    injectEnergy(12); 
    setTimeout(() => {
        document.getElementById('main-app-window').classList.add('active');
        document.getElementById('canvas').style.transform = 'scale(1)';
    }, 1000);
}

function returnToPortal(e) {
    if(e) e.preventDefault();
    isFlythroughActive = false;
    const overlay = document.getElementById('intro-overlay');
    if(hasEntered) overlay.classList.add('observer-mode');
    autonomousUpdate();
    document.getElementById('main-app-window').classList.remove('active');
    overlay.classList.remove('intro-hidden');
    document.getElementById('canvas').style.transform = 'scale(1.2)';
}

function autonomousUpdate() {
    const res = RESONANCE_SPECTRUM[Math.floor(Math.random() * RESONANCE_SPECTRUM.length)];
    activeColor = {r: res.r, g: res.g, b: res.b};
    targetP1 = res.p1; targetP2 = res.p2; mode = res.mode;
    targetTopology = Math.random() > 0.5 ? 1 : 0;
    document.documentElement.style.setProperty('--main-color', `rgb(${res.r}, ${res.g}, ${res.b})`);
    injectEnergy(20);
    autoTimer = 0;
}

async function sendToApi() {
    const btn = document.getElementById('api-btn');
    const msg = document.getElementById('message-body').value;
    if(!msg) return;
    btn.disabled = true;
    btn.innerText = "TRANSMITTING...";
    try {
        console.log("Mock API sent:", msg);
        autonomousUpdate();
        alert("Transmission logged in the cloud.");
    } catch (error) {
        console.error("API Error:", error);
    } finally {
        btn.disabled = false;
        btn.innerText = "TRANSMIT TO CLOUD";
    }
}

function injectEnergy(amount) {
    for (let i = 0; i < CONFIG.particleCount; i++) {
        x[i] = Math.random() * width; y[i] = Math.random() * height;
        vx[i] = (Math.random() - 0.5) * amount; vy[i] = (Math.random() - 0.5) * amount;
        settled[i] = 0;
    }
}

function handleNavigation(e, el, id) {
    if(e) e.preventDefault();
    if (id === currentView) return;
    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
    el.classList.add('active');
    const prevPane = document.getElementById(currentView);
    const nextPane = document.getElementById(id);
    prevPane.classList.remove('active');
    setTimeout(() => {
        prevPane.style.display = 'none';
        nextPane.style.display = 'block';
        nextPane.offsetHeight; 
        nextPane.classList.add('active');
        currentView = id;
    }, 300);
}

function evaluateField(px, py) {
    let aspect = width / height;
    let zoom = (mode === 0 || mode === 5) ? 1.0 : 0.5;
    let nx = ((px / width) - 0.5) * 2 * aspect * zoom;
    let ny = ((py / height) - 0.5) * 2 * zoom;
    if (mode === 0) return Math.abs(Math.cos(p1 * Math.PI * nx) * Math.cos(p2 * Math.PI * ny) - Math.cos(p2 * Math.PI * nx) * Math.cos(p1 * Math.PI * ny));
    if (mode === 1) { 
        let zx = nx, zy = ny, i = 0;
        while(zx*zx + zy*zy < 4 && i < 45) {
            let t = zx*zx - zy*zy + (p1/12 - 0.4); zy = 2*zx*zy + (p2/12 - 0.4); zx = t; i++;
        }
        return i / 45;
    }
    if (mode === 5) return Math.abs(Math.sin(nx * p1 + time) * Math.cos(ny * p2 + time));
    let zx = nx, zy = ny, i = 0;
    while(zx*zx + zy*zy < 4 && i < 30) {
        let tx = zx*zx - zy*zy + (p1/15);
        zy = (mode === 3 ? Math.abs(2*zx*zy) : 2*zx*zy) + (p2/15);
        zx = (mode === 4 ? -tx : tx); i++;
    }
    return i / 30;
}

function project3D(px, py) {
    let aspect = width / height;
    let u = ((px / width) - 0.5) * 2 * aspect;
    let v = ((py / height) - 0.5) * 2;
    const depth = (u + 1.2) * 2.0 + 0.2;
    if (depth < 0.1) return null;
    const radius = 1.2 / depth; const angle = v * Math.PI + time * 0.12;
    let p3x = radius * Math.cos(angle), p3y = radius * Math.sin(angle), p3z = depth - 2.0;
    const scale = CONFIG.focalLength / (CONFIG.focalLength + p3z * 350);
    return { x: p3x * 550 * scale + centerX, y: p3y * 550 * scale + centerY, s: scale, z: p3z };
}

function updatePhysics() {
    time += 0.01; autoTimer++;
    if (autoTimer > CONFIG.autoSkipTime) {
        mode = Math.floor(Math.random() * 6); targetTopology = Math.random() > 0.5 ? 1 : 0; 
        targetP1 = 2 + Math.random() * 9; targetP2 = 2 + Math.random() * 9; 
        lerpProgress = 0; autoTimer = 0;
        document.getElementById('mode-disp').innerText = ["CHLADNI", "JULIA", "MANDEL", "VOID", "TRICORN", "FLUX"][mode];
        document.getElementById('view-disp').innerText = targetTopology === 0 ? "FLAT" : "TUNNEL";
    }
    p1 += (targetP1 - p1) * 0.03; p2 += (targetP2 - p2) * 0.03;
    topology += (targetTopology - topology) * 0.008; 
    document.getElementById('progress-bar').style.width = (lerpProgress < 1.0 ? (lerpProgress += 0.002) * 100 : 100) + "%";

    for (let i = 0; i < CONFIG.particleCount; i++) {
        const f = evaluateField(x[i], y[i]); age[i] += 0.1;
        if (f > 0.12) {
            vx[i] += (Math.random()-0.5) * f * CONFIG.vibrationStrength;
            vy[i] += (Math.random()-0.5) * f * CONFIG.vibrationStrength;
            settled[i] = Math.max(0, settled[i] - 0.25);
        } else {
            vx[i] *= 0.55; vy[i] *= 0.55; settled[i] = Math.min(1, settled[i] + 0.1);
        }
        x[i] += vx[i]; y[i] += vy[i];
        vx[i] *= CONFIG.friction; vy[i] *= CONFIG.friction;
        if (age[i] > 1000 || x[i] < 0 || x[i] > width || y[i] < 0 || y[i] > height) {
            x[i] = Math.random() * width; y[i] = Math.random() * height; vx[i] = 0; vy[i] = 0; age[i] = 0;
        }
    }
}

function draw() {
    ctx.fillStyle = 'rgba(5, 5, 5, 0.25)'; ctx.fillRect(0, 0, width, height);
    ctx.globalCompositeOperation = 'lighter';
    for (let i = 0; i < CONFIG.particleCount; i++) {
        let dx = x[i], dy = y[i], dSize = CONFIG.pixelSize, alphaMod = 1.0;
        if (topology > 0.001) {
            const p3 = project3D(x[i], y[i]);
            if (!p3) alphaMod = 0; else {
                let t = topology * topology * (3 - 2 * topology);
                dx = dx * (1 - t) + p3.x * t; dy = dy * (1 - t) + p3.y * t;
                dSize = dSize * (1 - t) + (CONFIG.pixelSize * p3.s) * t;
            }
        }
        if (alphaMod <= 0.01) continue;
        let s = settled[i];
        let r = activeColor.r, g = activeColor.g, b = activeColor.b;
        if (s < 0.6) { r *= 0.2; g *= 0.2; b *= 0.2; } 
        ctx.fillStyle = `rgba(${r}, ${g}, ${b}, ${s * alphaMod * 0.4})`;
        ctx.fillRect(dx - dSize/2, dy - dSize/2, dSize, dSize);
    }
    ctx.globalCompositeOperation = 'source-over';
}

function init() {
    canvas = document.getElementById('canvas'); ctx = canvas.getContext('2d');
    resize();
    for (let i = 0; i < CONFIG.particleCount; i++) { x[i] = Math.random() * width; y[i] = Math.random() * height; }
    function loop() { updatePhysics(); draw(); requestAnimationFrame(loop); }
    loop();
}

function resize() { width = canvas.width = window.innerWidth; height = canvas.height = window.innerHeight; centerX = width/2; centerY = height/2; }
window.onload = init;
window.onresize = resize;
</script>
</body>
</html>